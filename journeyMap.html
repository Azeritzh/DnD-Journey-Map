<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <title>DnD Interactive Journey Map</title>
        <style>
           
        </style>
    </head>
    <body style="margin:0;">
        <canvas id="backgroundCanvas" style="display: block;">
            <img id="background" src="images/map.jpg" />
        </canvas>
    </body>
    <script>
        window.onload = function(){
            redraw()
        }

        //variables
        var state = {
            x: 0,
            y: 0,
            zoom: 1
        }
        var backgrCanvas = document.getElementById("backgroundCanvas");
        var ctx = backgrCanvas.getContext("2d");
        var mouseX;
        var mouseY;
        var img = new Image();
        img.src = "images/map.jpg"
        var dragging = false;
        var mouseclicked = false;
        var mouseUpScroll = false;

        //Redraws the canvas after events
        function redraw(){
            ctx.clearRect(0, 0, backgrCanvas.width, backgrCanvas.height )
            ctx.imageSmoothingEnabled = false;
            ctx.drawImage(img, state.x, state.y, img.width * state.zoom, img.height * state.zoom);
        }

        //Eventlisteners for mouse events
        backgrCanvas.addEventListener("mousedown", function(event){
            dragging = false;
            mouseclicked = true;
            getMouseClickPos(event);
        })
        backgrCanvas.addEventListener("mouseup", function(){
            mouseclicked = false;
        })
        backgrCanvas.addEventListener("mousemove", function(event){
            if(mouseclicked == true){
                dragging = true;
                updateDragmap(event);
                redraw();
            } else {
                dragging = false;
            }
        })
        backgrCanvas.addEventListener("mousewheel", function(event){
            if(event.wheelDelta > 0){
                mouseUpScroll = false;
                state.zoom *= 1.2;
            } else{
                mouseUpScroll = true;
                state.zoom /= 1.2;
            }
            redraw();
        })

        function getMouseClickPos(event){
            mouseX = event.x;
            mouseY = event.y;
        }

        //Updates Position for map when dragged
        function updateDragmap(event){
            var posDifferenceX = event.x - mouseX;
            var posDifferenceY = event.y - mouseY;
            mouseX = event.x;
            mouseY = event.y;

            state.x = state.x + posDifferenceX
            state.y = state.y + posDifferenceY
        }

        //Handles the redrawing of the canvas when the window resizes
        window.addEventListener("resize", resizeCanvas, false);

        function resizeCanvas(){
            backgrCanvas.width = window.innerWidth
            backgrCanvas.height = window.innerHeight
            redraw()
        }
        resizeCanvas()
    </script>
</html>